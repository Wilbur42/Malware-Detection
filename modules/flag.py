import json

import pandas as pd
import numpy as np

if __name__ == '__main__':

    # Load Datasets
    benign_df = pd.read_csv('./data/benign_data.csv')
    malware_df = pd.read_csv('./data/malware_data.csv')

    # Concatenate the dataframes into one dataframe
    df = pd.concat([benign_df, malware_df], ignore_index=True)

    # Create a dictionary for each column containing
    #   each unique value and its occurrences
    attrs = {}

    # Iterate over each column
    for col in df.columns:
        attrs[col] = {}

        # Iterate over each unique value in the column
        for val in df[col].unique():
            # Get the counts of the value in benign and malware datasets
            benign_count = benign_df[col].value_counts().get(val, 0)
            malware_count = malware_df[col].value_counts().get(val, 0)

            # Store the counts in the dictionary as [benign_count, malware_count]
            # TODO: Add the total counts for each value in each column
            attrs[col][val] = [benign_count, malware_count]

    # TODO: Compare occourances of each value to determine which values are
    #       more likely to be benign or malware

    # TODO: Implement a check for the 'flaged' values

    # TODO: Check for file extensions that are more likely to be benign or malware
    #       that are not PE file extensions (basic list)

    # Write to a file
    with open('./data/test.json', 'w', encoding='utf-8') as f:
        json.dump(attrs, f, indent=4)