import json
import os

## Change the below variables as necessary ##

BENIGN_FILE_PATHS = ['C:\\', 'D:\\'] # Sourced from local machine

MALWARE_FILE_PATHS = ['E:\\VirusShare'] # Sourced from VirusShare (https://virusshare.com/)

# Junctions and folders to ignore when traversing file system
IGNORED_FOLDERS = [
    '$Recycle.Bin',
    'Documents and Settings',
    'Application Data',
    'Cookies',
    'Local Settings',
    'NetHood',
    'PrintHood',
    'Recent',
    'SendTo',
    'Start Menu',
    'Templates',
    'Temporary Internet Files'
]

## End of variables ##

def get_files(path):

    for element in os.listdir(path):
        if element in IGNORED_FOLDERS:
            continue
        element_path = os.path.join(path, element)
        if os.path.isfile(element_path):
            yield element_path
        elif os.path.isdir(element_path):
            yield from get_files(element_path)

if __name__ == '__main__':

    # Get benign files

    files = []
    for path in BENIGN_FILE_PATHS:
        files.extend(get_files(path))

    with open('benign_files.json', 'w', encoding='utf-8') as f:
        json.dump(files, f, indent=4)

    # Get malware files

    files = []
    for path in MALWARE_FILE_PATHS:
        files.extend(get_files(path))

    with open('malware_files.json', 'w', encoding='utf-8') as f:
        json.dump(files, f, indent=4)
